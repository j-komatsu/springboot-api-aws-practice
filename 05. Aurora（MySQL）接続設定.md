# 05. Auroraï¼ˆMySQLï¼‰æ¥ç¶šè¨­å®š

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Spring Boot ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ AWS Auroraï¼ˆMySQL äº’æ›ï¼‰ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æ‰‹é †ã¨è¨­å®šã‚’ã¾ã¨ã‚ã¾ã™ã€‚

---

## ğŸ§± æ§‹æˆæ¦‚è¦

| é …ç›® | å†…å®¹ |
|------|------|
| DBç¨®é¡ | Amazon Aurora (MySQL äº’æ›) |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¾‹ | Aurora MySQL 5.7 / 8.0 |
| æ¥ç¶šæ–¹å¼ | JDBCï¼ˆapplication.properties/ymlï¼‰ |
| ãƒ‰ãƒ©ã‚¤ãƒ | `mysql-connector-j` |

---

## ğŸ›  Aurora æ§‹ç¯‰ï¼ˆTerraformä¾‹ï¼‰

```hcl
resource "aws_rds_cluster" "aurora_cluster" {
  cluster_identifier = "sample-aurora-cluster"
  engine             = "aurora-mysql"
  engine_mode        = "provisioned"
  master_username    = "admin"
  master_password    = "your-secure-password"
  backup_retention_period = 5
  skip_final_snapshot     = true
}

resource "aws_rds_cluster_instance" "aurora_instance" {
  count              = 2
  identifier         = "aurora-instance-${count.index}"
  cluster_identifier = aws_rds_cluster.aurora_cluster.id
  instance_class     = "db.t3.medium"
  engine             = aws_rds_cluster.aurora_cluster.engine
}
```

---

## ğŸ”— Spring Boot å´ã®æ¥ç¶šè¨­å®š

`application.properties` ã¾ãŸã¯ `application.yml` ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```properties
spring.datasource.url=jdbc:mysql://{ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ}:3306/{DBå}
spring.datasource.username=admin
spring.datasource.password=ï¼ˆè¨­å®šã—ãŸãƒ‘ã‚¹ï¼‰
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect
```
{ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ}ï¼šRDS ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ã€ŒWriter ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€  
{DBå}ï¼šä½œæˆã—ãŸã‚¹ã‚­ãƒ¼ãƒåï¼ˆä¾‹ï¼šbookapi_dbï¼‰  

---

## ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®è¿½åŠ ï¼ˆpom.xmlï¼‰
5.7  
```xml
<dependency>
  <groupId>mysql</groupId>
  <artifactId>mysql-connector-java</artifactId>
  <version>5.1.49</version>
</dependency>

```
  
8.0  
```xml
<dependency>
  <groupId>mysql</groupId>
  <artifactId>mysql-connector-j</artifactId>
  <version>8.0.33</version>
</dependency>
```

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ§‹æˆã®æ³¨æ„

- Aurora ã® **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—** ã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆEC2/Beanstalkï¼‰ã® **ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯** ã‚’è¨­å®šã™ã‚‹ã€‚
- VPC å†…ã§æ¥ç¶šã‚’è¡Œã†æ§‹æˆã¨ã™ã‚‹ã€‚

---

## ğŸ§ª å‹•ä½œç¢ºèªæ–¹æ³•

1. Aurora ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèªï¼ˆAWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰
2. Spring Boot ã‚¢ãƒ—ãƒªã‚’èµ·å‹•
3. æ¥ç¶šãƒ­ã‚° or ã‚¨ãƒ©ãƒ¼ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã‹ç¢ºèª
4. åˆå›ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã•ã‚Œã‚‹ã‹ç¢ºèªï¼ˆ`spring.jpa.hibernate.ddl-auto=update`ï¼‰

---

## ğŸš¨ ã‚ˆãã‚ã‚‹æ¥ç¶šã‚¨ãƒ©ãƒ¼

| ã‚¨ãƒ©ãƒ¼å†…å®¹ | åŸå› ã¨å¯¾ç­– |
|------------|------------|
| Timeout | SG ã§ãƒãƒ¼ãƒˆ 3306 ãŒé–‹ã„ã¦ã„ãªã„ï¼VPCãŒé•ã† |
| Access Denied | ãƒ¦ãƒ¼ã‚¶ãƒ¼å or ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é–“é•ã„ |
| Unknown database | JDBC URL ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åãŒæœªä½œæˆ |

---

## ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯

- [Amazon Auroraï¼ˆMySQLï¼‰å…¬å¼](https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/)
- [Spring Boot + MySQL æ¥ç¶š](https://spring.io/guides/gs/accessing-data-mysql/)



# Auroraï¼ˆMySQLï¼‰ä½œæˆã¨æ¥ç¶šè¨­å®šæ‰‹é †

AWS Auroraï¼ˆMySQL äº’æ›ï¼‰ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æ‰‹é †ã¨è¨­å®šã‚’ã¾ã¨ã‚ã¾ã™ã€‚

---

## ğŸ§± AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«
 ã‚¹ãƒ†ãƒƒãƒ—1ï¼šAurora (MySQLäº’æ›) RDS ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ä½œæˆ  
1. RDS ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã  
[AWSãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«] â†’ [RDS] â†’ [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ]  
![image](https://github.com/user-attachments/assets/be4dd68d-5577-453b-951f-4e7f7f406e2b)

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆå¾Œã€èµ·å‹•ç¢ºèª
![image](https://github.com/user-attachments/assets/bcdd44cf-4af0-493e-baac-aa6e84972358)


end


