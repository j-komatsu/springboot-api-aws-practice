# 04. Terraform ã«ã‚ˆã‚‹ CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Terraform ã‚’ä½¿ç”¨ã—ã¦ AWS ç’°å¢ƒã‚’ã‚³ãƒ¼ãƒ‰åŒ–ï¼ˆIaCï¼‰ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆCI/CDï¼‰ã‚’æ§‹ç¯‰ã™ã‚‹æ‰‹é †ã‚’ã¾ã¨ã‚ã¾ã™ã€‚

---

## ğŸš€ æ§‹æˆæ¦‚è¦

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å†…å®¹ |
|----------------|------|
| IaC            | Terraform |
| CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ | GitHub Actionsï¼ˆäºˆå®šï¼‰ |
| AWSãƒªã‚½ãƒ¼ã‚¹     | Elastic Beanstalk / S3 / RDS / IAM ãªã© |

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆäºˆå®šï¼‰

```
terraform/
â”œâ”€â”€ main.tf
â”œâ”€â”€ variables.tf
â”œâ”€â”€ outputs.tf
â”œâ”€â”€ backend.tf           # S3 + DynamoDB ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†ï¼ˆæ¨å¥¨ï¼‰
â””â”€â”€ environments/
    â””â”€â”€ dev/
        â”œâ”€â”€ main.tf
        â”œâ”€â”€ variables.tf
        â””â”€â”€ terraform.tfvars
```

---

## ğŸ”§ ä½¿ç”¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆäºˆå®šï¼‰

- `aws_elastic_beanstalk_application`
- `aws_elastic_beanstalk_environment`
- `aws_rds_cluster`
- `aws_iam_role`, `aws_iam_policy`
- `aws_s3_bucket`
- `aws_codedeploy_app`ï¼ˆæ‹¡å¼µæ™‚ï¼‰

---

## ğŸ›  åˆæœŸè¨­å®šï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

```bash
brew install terraform       # Mac
choco install terraform      # Windows
terraform -version
```

---

## ğŸŒ± åˆæœŸåŒ–ã¨ãƒ—ãƒ©ãƒ³ç¢ºèª

```bash
terraform init
terraform plan
```

---

## ğŸš€ é©ç”¨ï¼ˆãƒªã‚½ãƒ¼ã‚¹ä½œæˆï¼‰

```bash
terraform apply
```

---

## ğŸ“¦ ä»Šå¾Œè¿½åŠ äºˆå®šã®æ§‹æˆ

- GitHub Actions ã«ã‚ˆã‚‹è‡ªå‹• `terraform apply`
- secrets ç®¡ç†ï¼ˆGitHub Secretsï¼‰
- Aurora RDS æ¥ç¶šè¨­å®šï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—å«ã‚€ï¼‰
- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ï¼æœ¬ç•ªç’°å¢ƒã®åˆ‡ã‚Šåˆ†ã‘ï¼ˆworkspaces or envãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰

---

## ğŸ“˜ è£œè¶³

- `terraform.tfstate` ã¯ S3 ã§ç®¡ç†æ¨å¥¨ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­å®šï¼‰
- `destroy` ã§ãƒªã‚½ãƒ¼ã‚¹å…¨å‰Šé™¤å¯èƒ½ï¼š**æ…é‡ã«å®Ÿè¡Œ**
  ```bash
  terraform destroy
  ```

---

## ğŸ“ å‚è€ƒãƒªãƒ³ã‚¯

- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [Terraform Beanstalk Module (community)](https://registry.terraform.io/modules)

