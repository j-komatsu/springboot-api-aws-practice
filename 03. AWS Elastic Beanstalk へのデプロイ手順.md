# 03. AWS Elastic Beanstalk へのデプロイ手順

このドキュメントでは、Spring Boot アプリケーションを AWS Elastic Beanstalk にデプロイするための基本手順をまとめます。

---

## ☁ 使用サービス構成

- **EC2**：アプリケーションが動作する仮想サーバー
- **Elastic Beanstalk**：アプリケーションのデプロイ・スケーリングを管理
- **RDS（Aurora）**：バックエンドデータベース（別途構成）

---

## 📦 前提条件

- AWS アカウントが作成済み
- Spring Boot アプリが `.jar` でビルド可能
- Maven or `mvnw` が利用できる（→補足あり）

---

## 🛠 デプロイ手順（AWS マネジメントコンソールを使用）

### 1. アプリケーションをビルド

```bash
./mvnw.cmd clean package

・テストでエラーが出る場合はスキップする
./mvnw.cmd clean package -DskipTests
```

- `target/` フォルダに `springboot-book-api-0.0.1-SNAPSHOT.jar` が生成されます。

### 2. AWS マネジメントコンソールにアクセス

1. AWSコンソールにログインし、「Elastic Beanstalk」を開く
2. 「アプリケーションの作成」をクリック
3. 以下を設定：
   - アプリケーション名：任意（例：`springboot-book-api`）
   - プラットフォーム：Java（Corretto 11など）
   - アプリケーションコード：一旦「サンプルアプリケーション」でもOK
4. 環境の作成後、「アップロードとデプロイ」で JAR ファイルを指定し、デプロイ実行

### 3. アプリ確認

作成された環境URLにアクセスし、デプロイしたアプリが表示されるか確認：

```
https://<環境名>.<リージョン>.elasticbeanstalk.com/
```

---

## 🔄 コマンドライン経由の手順（参考）

### Beanstalk 初期化（初回のみ）

```bash
eb init
```

- 対話形式で設定（プラットフォーム、リージョンなど）

### 環境作成（初回のみ）

```bash
eb create springboot-api-env
```

### デプロイ実行

```bash
eb deploy
```

---

## 📁 `.elasticbeanstalk/config.yml` の例

```yaml
global:
  application_name: springboot-api-app
  default_region: ap-northeast-1
  platform: Corretto 11
  branch-defaults:
    default:
      environment: springboot-api-env
```

---

## 📚 補足情報

### ✅ `mvnw` とは？

- `mvnw` は **Maven Wrapper** と呼ばれ、Maven をインストールせずにプロジェクトごとのバージョンで Maven を実行可能。
- システムに Maven がなくても、`./mvnw` を使えば Maven が自動でダウンロード＆実行される。
- `mvnw.cmd`（Windows） や `./mvnw`（Mac/Linux）として使用。

#### 例：

```bash
./mvnw clean package        # jarビルド
./mvnw spring-boot:run      # アプリ起動
```

---

## 🚀 今後の拡張予定

- [ ] Aurora RDS 接続設定
- [ ] カスタムドメイン設定
- [ ] HTTPS（TLS）化
- [ ] GitHub Actions によるCI/CD自動化

