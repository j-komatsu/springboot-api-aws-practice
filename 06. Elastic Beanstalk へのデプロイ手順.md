# 06. Elastic Beanstalk ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Spring Boot ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ AWS Elastic Beanstalkï¼ˆTomcat ç’°å¢ƒï¼‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ‰‹é †ã‚’ã¾ã¨ã‚ã¾ã™ã€‚

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆ

| é …ç›®         | å†…å®¹                          |
|--------------|-------------------------------|
| ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ | Spring Boot ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆjarï¼‰ |
| å®Ÿè¡Œç’°å¢ƒ     | Elastic Beanstalkï¼ˆJava SEï¼‰   |
| EC2ã‚¿ã‚¤ãƒ—     | Amazon Linux 2 + Java 11       |
| ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• | AWS CLI / ã‚³ãƒ³ã‚½ãƒ¼ãƒ« / CI/CD  |

---

## ğŸ“¦ ãƒ“ãƒ«ãƒ‰ï¼šjarãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```bash
./mvnw clean package
```

`target/` ãƒ•ã‚©ãƒ«ãƒ€å†…ã« `springboot-book-api-0.0.1-SNAPSHOT.jar` ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰

Beanstalk ã¯ `.zip` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ãŸ jar ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```
deploy/
â”œâ”€â”€ springboot-book-api.jar  â† åå‰ã‚’ãƒªãƒãƒ¼ãƒ ã—ã¦ã‚‚OK
â””â”€â”€ Procfile
```

---

## ğŸ“ Procfile ã®ä½œæˆ

`deploy/Procfile` ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã‚’è¨˜è¿°ï¼š

```procfile
web: java -jar springboot-book-api.jar
```

---

## ğŸ“¦ zip ã«å›ºã‚ã‚‹

```bash
cd deploy
zip deploy.zip springboot-book-api.jar Procfile
```

---

## â˜ ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•â‘ ï¼šãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰

1. Elastic Beanstalk ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
2. ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ã€ŒJavaã€é¸æŠï¼ˆJava 11ï¼‰
3. ä½œæˆå¾Œã€zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤

---

## ğŸ–¥ ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•â‘¡ï¼šAWS CLI

```bash
aws elasticbeanstalk create-application-version \
  --application-name springboot-book-api \
  --version-label v1 \
  --source-bundle S3Bucket=my-bucket,S3Key=deploy.zip

aws elasticbeanstalk update-environment \
  --environment-name springboot-book-api-env \
  --version-label v1
```

---

## âœ… ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèª

Elastic Beanstalk ã®ã€Œç’°å¢ƒURLã€ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚Œã°OKï¼

---

## ğŸ§© ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| ç¾è±¡ | åŸå› ã¨å¯¾ç­– |
|------|------------|
| ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ãªã„ | Procfile ã®ãƒ‘ã‚¹ãƒ»jaråãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèª |
| 502 Bad Gateway | jar ã®ã‚¨ãƒ©ãƒ¼ï¼Beanstalkãƒ­ã‚°ã§åŸå› ç¢ºèª |
| Java ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸ä¸€è‡´ | ç’°å¢ƒè¨­å®šã§ Java11 ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª |
| DB æ¥ç¶šã‚¨ãƒ©ãƒ¼ | Aurora ã¨ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ï¼VPCè¨­å®š |

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [Elastic Beanstalk Java ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-se-platform.html)
- [Procfile ä»•æ§˜](https://devcenter.heroku.com/articles/procfile)

